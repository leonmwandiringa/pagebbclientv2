<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Tell the browser to be responsive to screen width -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- Favicon icon -->
    <link rel="icon" href="https://assets.xbox.com/xbcservicewebwww-1805-23141-0-0-main-rolling/shell/images/favicon.ico">
    <title>Builder</title>
    <!-- Bootstrap Core CSS -->
    <link href="assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/dragula.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="css/style.css" rel="stylesheet">

    <link href="css/sweetalert.css" rel="stylesheet">
    <!-- You can change the theme colors from here -->

    <style>
        .page-titles {
            margin: 0 -30px 0px;
        }
        #dragtocontainer .dragcontainer{
            margin: 20px 20px;
            padding: 40px 10px 10px;
            border: 2px solid #1e88e5;
            border-radius: 10px;
            position: relative;
            transition: 1s all;
        }

        #dragablecomponents div, #dragablecomponents div:focus, #dragablecomponents div:hover, #dragablecomponents div:active{
            cursor: move !important;
        }

        #dragtocontainer .innercontent{
            background: white;
            border: 2px solid #b9b9b9;
            border-radius: 10px;
            padding: 10px;
        }

        .dragcontainer.active{
            background: #1e88e5;
        }

        #dragablecomponents .dragcontainer{
            padding: 10px 0 10px 10px;
            margin: 10px 0;
            background: #e8e8e8;
            border-radius: 10px;
        }
    </style>
    <link href="css/colors/blue.css" id="theme" rel="stylesheet">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
</head>

<body class="fix-header fix-sidebar card-no-border">
    <!-- ============================================================== -->
    <!-- Preloader - style you can find in spinners.css -->
    <!-- ============================================================== -->
    <div class="preloader">
        <svg class="circular" viewBox="25 25 50 50">
            <circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10" /> </svg>
    </div>
    <!-- ============================================================== -->
    <!-- Main wrapper - style you can find in pages.scss -->
    <!-- ============================================================== -->
    <div id="main-wrapper">
        <!-- ============================================================== -->
        <!-- Topbar header - style you can find in pages.scss -->
        <!-- ============================================================== -->
        <header class="topbar">
            <nav class="navbar top-navbar navbar-toggleable-sm navbar-light">

                <div class="navbar-header">
                    <a class="navbar-brand" href="/">
                        <!-- Logo icon --><b>
                            <!--You can put here icon as well // <i class="wi wi-sunset"></i> //-->
                            
                            <!-- Light Logo icon -->
                            <!-- <img src="assets/images/gennielogo2.png" style="width: 40px;" alt="homepage" class="light-logo" /> -->
                        </b>
                        <!--End Logo icon -->
                        <!-- Logo text --><span>
                         
                         <!-- Light Logo text   
                          <img src="assets/images/gennielogo2.png" class="light-logo img-responsive" style="width: 40px;" alt="homepage" /></span> </a> */ --> 
                </div>

                <div class="navbar-collapse">

                    <ul class="navbar-nav mr-auto mt-md-0">
                        <!-- This is  -->
                        <li class="nav-item"> <a class="nav-link nav-toggler hidden-md-up text-muted waves-effect waves-dark" href="javascript:void(0)"><i class="mdi mdi-menu"></i></a> </li>

                        
                        </li>
                    </ul>

                    <ul class="navbar-nav my-lg-0">

                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle has-arrow waves-effect waves-dark" href="" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">user<span class="caret"></span></a>
                        </li>
                    </ul>
                </div>
            </nav>
        </header>

         

        <div class="page-wrapper" style="">

            <div class="container-fluid">

                <div class="row">
                    <div class="col-9" id="dragtocontainer" style="margin-top: 40px;height: 100vh;">


                        <div class="editingArea col-9" style="width: 100%; min-height: 20vh; position: fixed; bottom: 0;background-color: #e6e6e6;box-shadow: 0 0 10px;;left: 0;padding: 20px 50px;">
            
                        </div>
                    </div>
                    <div class="col-3" style="background-color: white;height: 100%;position: fixed;right: 0;padding-top: 20px;box-shadow: 0 0 10px 1px rgba(0, 0, 0, 0.32);" id="dragablecomponents">
                        <div class="dragcontainer" data-index=""><div class="innercontent" data-edit="text">Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy </div></div>
                        <div class="dragcontainer" data-index="0"><div class="innercontent" data-edit="text">aining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lore</div></div>
                    </div>
                </div>
                <!-- ============================================================== -->
                <!-- End PAge Content -->
                <!-- ============================================================== -->
            
                
        </div>



        </div>
        <!-- ============================================================== -->
        <!-- End Page wrapper  -->
        <!-- ============================================================== -->
    </div>

    <script src="assets/plugins/jquery/jquery.min.js"></script>
    <!-- Bootstrap tether Core JavaScript -->
    <script src="assets/plugins/bootstrap/js/tether.min.js"></script>
    <script src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>
    <!-- slimscrollbar scrollbar JavaScript -->
    <script src="js/jquery.slimscroll.js"></script>
    <!--Wave Effects -->
    <script src="js/waves.js"></script>
    <!--Menu sidebar -->
    <script src="js/sidebarmenu.js"></script>
    <!--stickey kit -->
    <script src="assets/plugins/sticky-kit-master/dist/sticky-kit.min.js"></script>
    <!--Custom JavaScript -->
    <script src="js/dragula.min.js"></script>
    <script src="js/custom.min.js"></script>
    <script>

        $(document).ready(function(){

            var drake = dragula([document.getElementById("dragablecomponents"), document.getElementById("dragtocontainer")], {
                copy: function (el, source) {
                  return source === document.getElementById("dragablecomponents")
                },
                accepts: function (el, target) {
                  return target !== document.getElementById("dragablecomponents")
                }
              });

              drake.on("drop", function(el, target, source, sibling){

                var editcontent = `<div class="modify" style="
                                    position: absolute;
                                    top: 0px;
                                    right: 2px;
                                "><button type="button" class="btn btn-primary waves-effect editbuilderBlock">Edit</button>
                                <button type="button" class="btn btn-danger waves-effect removebuilderBlock">Remove</button>
                                    </div>`;

                if(target && target.id == "dragtocontainer"){
                    $(el).find(".modify").remove();
                    $(el).prepend(editcontent);
                    //let index = $(el).index();
                    //$(el).attr("data-index", index);
                   //console.log("dopped", el, target, source, sibling, $(el).index());
                }
                
                $(".removebuilderBlock").click(removeBuilderBlock);
                $(".editbuilderBlock").click(EditThisCurrentBlock);
              })

              function removeBuilderBlock(e){

                let thisSection = $(this);
                swal({
                    title: 'Are you sure?',
                    text: "You won't be able to revert this!",
                    type: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Yes, Remove!'
                    }, (result) => {
                    if (result) {

                        thisSection.closest(".dragcontainer").remove();

                        swal(
                        'Removed!',
                        'Section has been removed.',
                        'success'
                        )
                    }
                })


              }
              
              //edit onclick
              function EditThisCurrentBlock(){

                  $(".dragcontainer").removeClass("active");
                  $(this).closest(".dragcontainer").addClass("active");
                  let tobeEdited = $(this).closest(".modify").siblings(".innercontent").data("edit");
                  let thisToedit = $(this).closest(".modify").siblings(".innercontent");

                  if(tobeEdited && tobeEdited == 'text'){

                      startShowingEdits(thisToedit, "text");

                  }

              }

              //passing edit data
              function startShowingEdits(thisEdit, type){
                  let htmlArray = [];

                  switch(type){
                      case "text":
                            htmlArray[htmlArray.length] = `<div class="form-group">
                                        <label>Edit ${type} component</label>
                                        <textarea class="form-control" id="editPositionfield" rows="5">${thisEdit.text()}</textarea>
                                    </div>`;
                            break;
                      default:
                            htmlArray = [];

                  }
                
                //run through array and push values
                if(htmlArray.length > 0){
                    htmlArray.forEach((htmlForEditFields)=>{
                        $(".editingArea").empty().append(htmlForEditFields);
                    });
                    
                }

                $("#editPositionfield").keyup(function(){
                    //console.log($(this).val());
                    let keyVal = $(this).val().trim();

                    repondToChangestofield(thisEdit, keyVal);

                });

              }

              function repondToChangestofield(thisEdit, keyVal){

                $(thisEdit).text(keyVal);

              }

        });
    </script>
    <script src="js/sweetalert.min.js"></script>
</body>

</html>
